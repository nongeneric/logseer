include(GetPrerequisites)

set(VCPKG_ROOT @VCPKG_INSTALLED_DIR@/@VCPKG_TARGET_TRIPLET@)
set(ENABLE_DUDEN @ENABLE_DUDEN@)

function(install_boost_deps)
    get_prerequisites(${ARGV0} _prereq 0 1 "" "${VCPKG_ROOT}/bin")
    foreach(_dll IN LISTS _prereq)
        string(REGEX MATCH "boost_.*dll" _match ${_dll})
        if(_match)
            file(COPY "${VCPKG_ROOT}/bin/${_dll}" DESTINATION ${CMAKE_INSTALL_PREFIX})
        endif()
    endforeach()
endfunction()

file(COPY "@Qt6_ROOT@/plugins/platforms/qwindows.dll" DESTINATION ${CMAKE_INSTALL_PREFIX}/platforms)
file(COPY "@Qt6_ROOT@/plugins/imageformats/qsvg.dll" DESTINATION ${CMAKE_INSTALL_PREFIX}/imageformats)
file(COPY "@Qt6_ROOT@/bin/Qt6Svg.dll" DESTINATION ${CMAKE_INSTALL_PREFIX})
file(COPY "${VCPKG_ROOT}/bin/fmt.dll" DESTINATION ${CMAKE_INSTALL_PREFIX})
file(COPY "${VCPKG_ROOT}/bin/pcre2-8.dll" DESTINATION ${CMAKE_INSTALL_PREFIX})
file(COPY "${VCPKG_ROOT}/bin/pcre2-16.dll" DESTINATION ${CMAKE_INSTALL_PREFIX})
install_boost_deps(${CMAKE_INSTALL_PREFIX}/logseer.exe)
